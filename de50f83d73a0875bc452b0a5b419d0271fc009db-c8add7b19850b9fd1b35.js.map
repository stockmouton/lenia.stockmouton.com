{"version":3,"file":"de50f83d73a0875bc452b0a5b419d0271fc009db-c8add7b19850b9fd1b35.js","mappings":"48hDAOMA,GAAuBC,EAAAA,EAAAA,eAAc,MAE9BC,EACE,cADFA,EAEF,UAFEA,EAGH,SAQJC,EAAgB,SAACC,EAAiBC,GACtC,OAAIA,EAAqBH,EACrBE,EAAwBF,EACrBA,GAGII,EAAwB,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SACtC,GAAkCC,EAAAA,EAAAA,KAA1BC,EAAR,EAAQA,aAAcC,EAAtB,EAAsBA,QACtB,GAAgCC,EAAAA,EAAAA,UAAS,MAAlCC,EAAP,KAAiBC,EAAjB,KACA,GAAgDF,EAAAA,EAAAA,UAAS,GAAlDG,EAAP,KAAyBC,EAAzB,KACA,GAAgDJ,EAAAA,EAAAA,UAAS,GAAlDK,EAAP,KAAyBC,EAAzB,KACA,GAAoCN,EAAAA,EAAAA,UAAST,GAAtCgB,EAAP,KAAmBC,EAAnB,KACA,GAAwDR,EAAAA,EAAAA,WAAS,GAA1DS,EAAP,KAA6BC,EAA7B,KAEOC,GAAWC,EAAAA,EAAAA,IAAc,UAAWC,EAAAA,IAA3C,GAEMC,EAAe,WACnB,IACE,IAAMC,EAvBS,SAASJ,GAC5B,MAA8B,gBAA1B,MAAAK,OAAA,iBAAsD,YAAZL,EAA8BM,EAC9C,gBAA1B,MAAAD,OAAA,gBAA+CE,EAC5CC,EAoBeC,CAAaT,GACzBV,EAAWH,EAAe,IAAIA,EAAauB,IAAIC,SAASP,EAAUQ,UAAUC,MAAMC,IAAKV,EAAUQ,UAAUC,MAAME,SAAW,KAClIxB,EAAYD,GACZ,MAAM0B,GACNC,QAAQC,IAAIF,MAKhBG,EAAAA,EAAAA,WAAUhB,EAAc,CAAChB,IAEzB,IAAMiC,EAAkB,mCAAG,gGACrB9B,EADqB,iCAEOA,EAAS+B,QAAQvC,kBAAkBwC,KAAK,CAACC,KAAMnC,IAFtD,cAEjBN,EAFiB,gBAGYQ,EAAS+B,QAAQvB,qBAAqBV,GAASkC,KAAK,CAACC,KAAMnC,IAHvE,cAGjBU,EAHiB,gBAIIR,EAAS+B,QAAQtC,eAAeuC,KAAK,CAAEC,KAAMnC,IAJjD,cAIjBL,EAJiB,iBAKQO,EAAS+B,QAAQG,aAAaF,KAAK,CAAEC,KAAMnC,IALnD,kDAKiE,EALjE,eAKjBI,EALiB,eAMQF,EAAS+B,QAAQI,cAAcH,KAAK,CAAEC,KAAMnC,IANpD,kDAMkE,EANlE,QAMjBM,EANiB,KAOvBG,EAAchB,EAAcC,EAAiBC,IAC7CgB,EAAwBD,GACxBL,EAAoBiC,SAASlC,EAAkB,KAC/CG,EAAoB+B,SAAShC,EAAkB,KAVxB,4CAAH,qDAclBiC,EAAoB,mCAAG,+GAEMrC,EAAS+B,QAAQI,cAAcH,KAAK,CAAEC,KAAMnC,IAFlD,cAEnBM,EAFmB,gBAGUJ,EAAS+B,QAAQvB,qBAAqBV,GAASkC,KAAK,CAACC,KAAMnC,IAHrE,OAGnBU,EAHmB,OAKzBC,EAAwBD,GACxBH,EAAoB+B,SAAShC,EAAkB,KANtB,4GAAH,qDAY1B,OACE,gCACE,gBAAChB,EAAqBkD,SAAtB,CAA+BC,MAAO,CACpCvC,SAAAA,EACAa,aAAAA,EACAiB,mBAAAA,EACAO,qBAAAA,EACA/B,WAAAA,EACAE,qBAAAA,EACAN,iBAAAA,EACAE,iBAAAA,IACET,KAKG6C,EAAmB,kBAAMC,EAAAA,EAAAA,YAAWrD","sources":["webpack://lenia.stockmouton.com/./src/components/lenia-contract-provider.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react'\nimport { useQueryParam, StringParam } from \"use-query-params\";\nimport { useWeb3 } from \"./web3-provider\"\nimport artifactsMain from '../artifacts/main.json'\nimport artifactsRinkeby from '../artifacts/rinkeby.json'\nimport artifactsLocalhost from '../artifacts/localhost.json'\n\nconst leniaContractContext = createContext(null)\n\nexport const SALE_STATUSES = {\n  NOT_STARTED: 'NOT_STARTED',\n  PRESALE: 'PRESALE',\n  PUBLIC: 'PUBLIC',\n}\n\nconst getArtifacts = function(network) {\n  if (process?.env.NODE_ENV === 'production' && network === 'rinkeby') return artifactsRinkeby\n  if (process?.env.NODE_ENV === 'production') return artifactsMain\n  return artifactsLocalhost\n}\nconst getSaleStatus = (isPresaleActive, isSaleActive) => {\n  if (isSaleActive) return SALE_STATUSES.PUBLIC\n  if (isPresaleActive) return SALE_STATUSES.PRESALE\n  return SALE_STATUSES.NOT_STARTED\n}\n\nexport const LeniaContractProvider = ({ children }) => {\n  const { web3Provider, account } = useWeb3()\n  const [contract, setContract] = useState(null)\n  const [totalLeniaSupply, setTotalLeniaSupply] = useState(0)\n  const [totalLeniaMinted, setTotalLeniaMinted] = useState(0)\n  const [saleStatus, setSaleStatus] = useState(SALE_STATUSES.NOT_STARTED)\n  const [isEligibleForPresale, setIsEligibleForPresale] = useState(false)\n\n  const [network] = useQueryParam(\"network\", StringParam)\n  \n  const initContract = () => {\n    try {\n      const artifacts = getArtifacts(network)\n      const contract = web3Provider ? new web3Provider.eth.Contract(artifacts.contracts.Lenia.abi, artifacts.contracts.Lenia.address) : null\n      setContract(contract)\n    } catch(error) {\n      console.log(error)\n      // Contract is not deployed or the wrong artifact is being imported\n    }\n  }\n  \n  useEffect(initContract, [web3Provider])\n\n  const initBlockchainData = async () => {\n    if (contract) {\n      const isPresaleActive = await contract.methods.isPresaleActive().call({from: account})\n      const isEligibleForPresale = await contract.methods.isEligibleForPresale(account).call({from: account})\n      const isSaleActive = await contract.methods.isSaleActive().call({ from: account })      \n      const totalLeniaSupply = await contract.methods.MAX_SUPPLY().call({ from: account }) || 0\n      const totalLeniaMinted = await contract.methods.totalSupply().call({ from: account }) || 0\n      setSaleStatus(getSaleStatus(isPresaleActive, isSaleActive))\n      setIsEligibleForPresale(isEligibleForPresale)\n      setTotalLeniaSupply(parseInt(totalLeniaSupply, 10))\n      setTotalLeniaMinted(parseInt(totalLeniaMinted, 10))\n    }\n  }\n\n  const updateBlockchainData = async () => {\n    try {\n      const totalLeniaMinted = await contract.methods.totalSupply().call({ from: account })\n      const isEligibleForPresale = await contract.methods.isEligibleForPresale(account).call({from: account})\n      \n      setIsEligibleForPresale(isEligibleForPresale)\n      setTotalLeniaMinted(parseInt(totalLeniaMinted, 10))\n    } catch(error) {\n      // Do nothing, this is just a read operation, no need to scare the user.\n    }\n  }\n\n  return (\n    <>\n      <leniaContractContext.Provider value={{\n        contract,\n        initContract,\n        initBlockchainData,\n        updateBlockchainData,\n        saleStatus,\n        isEligibleForPresale,\n        totalLeniaSupply,\n        totalLeniaMinted,\n      }}>{children}</leniaContractContext.Provider>\n    </>\n  )\n}\n\nexport const useLeniaContract = () => useContext(leniaContractContext)"],"names":["leniaContractContext","createContext","SALE_STATUSES","getSaleStatus","isPresaleActive","isSaleActive","LeniaContractProvider","children","useWeb3","web3Provider","account","useState","contract","setContract","totalLeniaSupply","setTotalLeniaSupply","totalLeniaMinted","setTotalLeniaMinted","saleStatus","setSaleStatus","isEligibleForPresale","setIsEligibleForPresale","network","useQueryParam","StringParam","initContract","artifacts","process","artifactsRinkeby","artifactsMain","artifactsLocalhost","getArtifacts","eth","Contract","contracts","Lenia","abi","address","error","console","log","useEffect","initBlockchainData","methods","call","from","MAX_SUPPLY","totalSupply","parseInt","updateBlockchainData","Provider","value","useLeniaContract","useContext"],"sourceRoot":""}